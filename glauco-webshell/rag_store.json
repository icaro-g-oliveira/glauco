[
  "Abaixo, compreensÃµes que devem ser levadas como fundaÃ§Ã£o da compreensÃ£o nas interaÃ§Ãµes com o usuÃ¡rio.\n\n- A funÃ§Ã£o listar_arquivos_em_pasta(caminho_base = '.') recebe um Ãºnico parÃ¢metro que determina de onde a listagem comeÃ§a. Se nenhum valor for passado, ela usa \".\", que significa a pasta atual. VocÃª pode fornecer qualquer caminho relativo ou absoluto, como \"./src\", \"C:/Users/DEV/Desktop\", ou \"meus_arquivos/\". A funÃ§Ã£o garante que o caminho seja normalizado internamente e, a partir dele, percorre tudo recursivamente, identificando corretamente diretÃ³rios e arquivos reais. Em resumo, o parÃ¢metro define o ponto inicial da Ã¡rvore; a partir dele, toda a estrutura abaixo serÃ¡ descoberta e exibida.",
  "ğŸ§­ 1. AÃ‡Ã•ES WEB (NAVEGADOR)\n\n### ğŸ”— NavegaÃ§Ã£o\n**abrir_url(url)**  \nâ†’ Abre o endereÃ§o especificado.  \n> Internamente usa Browser.setUrl.\n\n**voltar()**  \nâ†’ Aciona um â€œbackâ€ no histÃ³rico do navegador.\n\n**atualizar()**  \nâ†’ Recarrega a pÃ¡gina atual (reload).\n\n---\n\n#### ğŸ” Busca e Input\n\n**digitar(selector, valor)**  \nâ†’ Define o valor de um input e dispara evento \"input\".  \n> Equivale a alguÃ©m digitando sem errar.\n\n**pressionar_enter(selector?)**  \nâ†’ Envia um KeyDown{Enter} para o elemento-alvo.  \nâ†’ Se selector nÃ£o Ã© informado, tenta usar o campo ativo.\n\n**limpar(selector)**  \nâ†’ Zera o valor do campo.\n\n---\n\n### ğŸ–±ï¸ Cliques e InteraÃ§Ãµes\n\n**clicar(selector)**  \nâ†’ Clica no elemento.  \n> Usado para botÃµes, links, thumbnails, vÃ­deos, tabs, filtros.\n\n**clicar_primeiro(selector)**  \nâ†’ Seleciona o primeiro elemento da lista e clica.\n\n**clicar_texto(contem_texto)**  \nâ†’ Acha elemento cujo texto *inclui* o termo e clica.\n\n**scroll(quantidade_px)**  \nâ†’ Rola verticalmente a pÃ¡gina.\n\n**scroll_para_baixo() / scroll_para_cima()**  \nâ†’ AÃ§Ãµes de rolagem inferidas.\n\n---\n\n### ğŸ“„ Leitura de PÃ¡gina / Inspect\n\n**ler_html()**  \nâ†’ Captura `document.documentElement.outerHTML`.\n\n**capturar_lista(selector)**  \nâ†’ Retorna array de texto/atributos dos matches.\n\n**existe(selector)**  \nâ†’ Boolean para saber se algo estÃ¡ presente.\n\n**aguardar(selector, timeout)**  \nâ†’ Espera elemento aparecer.\n\n**extrair_links(selector)**  \nâ†’ Retorna lista de links `href` (e fallback: innerText).\n\n---\n\n### ğŸ¥ YouTube â€“ AÃ§Ãµes Operacionais\n\n**abrir_primeiro_video()**  \nUsa heurÃ­sticas:  \n- ytd-video-renderer  \n- #thumbnail img  \n- #video-title  \n- ytd-rich-grid-media\n\n**abrir_canal()**  \nâ†’ clique em `ytd-channel-name a`.\n\n**abrir_resultado_pesquisa_texto(texto)**  \nâ†’ encontra resultado cujo tÃ­tulo inclui o texto.\n\n**rolar_resultados()**  \nâ†’ scroll + reavaliaÃ§Ã£o de miniaturas.\n\n---",
  "ğŸ—‚ï¸ 2. AÃ‡Ã•ES DE SISTEMA DE ARQUIVOS (FS)\n\n### ğŸ“ Estrutura de Pastas\n\n**fs_listar(path)**  \nâ†’ Lista tudo na pasta.\n\n**fs_listar_recursivo(path)**  \nâ†’ Caminha recursivamente.\n\n**fs_buscar(path, padrao)**  \nâ†’ Busca por nome (`*.pdf`, `*contrato*`, etc).\n\n**fs_buscar_contextual(path, termos[])**  \nâ†’ Usa nome + preview do conteÃºdo.  \n> Ex.: â€œdocumento contendo 2024 + orÃ§amentoâ€.\n\n---\n\n### ğŸ“„ Leitura de arquivos\n\n**fs_ler_texto(path)**  \nâ†’ LÃª `.txt`, `.md`, `.csv`, `.json`, `.rb`, `.html`.\n\n**fs_ler_pdf(path)**  \nâ†’ Retorna texto usando Docling.\n\n**fs_ler_planilha(path)**  \nâ†’ LÃª `.xlsx` / `.ods` como tabela.\n\n**fs_ler_imagem(path)**  \nâ†’ Retorna OCR (Tesseract / Python).\n\n---\n\n### âœï¸ Escrita e ManipulaÃ§Ã£o\n\n**fs_copiar(origem, destino)**\n\n**fs_mover(origem, destino)**\n\n**fs_deletar(path)**\n\n**fs_criar_pasta(path)**\n\n**fs_criar_arquivo(path, conteudo)**\n\n---\n\n### ğŸ§  InferÃªncia de Tipo de Arquivo\n\n**fs_inferir_tipo(extensÃ£o)**  \nâ†’ \"pdf\", \"texto\", \"planilha\", \"imagem\", \"json\", etc.\n\nUsado para inferir comportamento automÃ¡tico:  \n> â€œabrir arquivo de contratoâ€ â†’ acha pdf/word.  \n> â€œler planilha de comprasâ€ â†’ .xlsx/.csv.\n\n---",
  "ğŸ—ƒï¸ 3. AÃ‡Ã•ES DE DOCUMENTOS (Word, PDF, Planilha)\n\n### ğŸ“„ Word (DOCX)\n\n**docx_novo(modelo:nil)**  \nâ†’ Cria um docx do zero ou baseado em modelo.\n\n**docx_escrever(path, texto)**\n\n**docx_inserir_tabela(path, dados[][])**\n\n**docx_salvar(path)**\n\n---\n\n### ğŸ§¾ PDF\n\n**pdf_extrair_texto(path)**  \nâ†’ Usa python/docling.\n\n**pdf_extrair_paginas(path, intervalo)**\n\n**pdf_salvar_novo(path, conteudo_texto)**\n\n---\n\n### ğŸ“Š Planilhas\n\n**xls_ler(path)**  \nâ†’ retorna matriz.\n\n**xls_escrever(path, linha, coluna, valor)**\n\n**xls_nova(path)**\n\n**xls_salvar(path)**\n\n---",
  "ğŸªŸ 4. AÃ‡Ã•ES DE WINDOWS (OS)\n\n### ğŸ–¥ï¸ Janelas\n\n**win_abrir_exe(path)**  \nâ†’ abre programa.\n\n**win_focar_janela(titulo_contÃ©m)**  \nâ†’ ativa janela existente.\n\n**win_fechar_janela(titulo)**\n\n**win_teclar(tecla)**  \nâ†’ envia key event global (â€œEnterâ€, â€œCtrl+Câ€).\n\n**win_digitar(texto)**  \nâ†’ teclado global.\n\n**win_copiar() / win_colar() / win_recortar()**\n\n---\n\n### ğŸ“¸ Captura e Tela\n\n**win_screenshot(path)**  \nâ†’ captura de tela.\n\n**win_capturar_janela(titulo)**  \nâ†’ screenshot especÃ­fico.\n\n---\n\n### ğŸ–±ï¸ Mouse\n\n**win_mouse_click(x, y)**\n\n**win_mouse_mover(x, y)**\n\n**win_mouse_scroll(px)**\n\n---\n\n\n### Comandos gerais\n\n**cmd_executar(\"comando\")**\n\n**ps_executar(\"comando\")**\n\n### Exemplos inferÃ­veis:\n\n- listar processos â†’ `tasklist`\n- matar processo â†’ `taskkill /IM nome`\n- listar pastas â†’ `dir`\n- copiar â†’ `copy origem destino`\n- mover â†’ `move origem destino`\n\n---",
  "ğŸ”— 6. AÃ‡Ã•ES DE INTEGRAÃ‡ÃƒO (LLM)\n\n### OperaÃ§Ãµes informacionais\n\n**llm_resumir(texto)**  \n**llm_extrair_itens(texto)**  \n**llm_classificar(tipo)**  \n**llm_gerar_json(modelo)**  \n\nÃšteis para pipeline:  \n> pdf â†’ extrair â†’ resumir â†’ organizar â†’ salvar.\n\n---",
  "ğŸ§© 7. AÃ§Ãµes Atomizadas (Granulares)\n\nCada comando acima Ã© **atÃ´mico**:  \nâ†’ o agente sÃ³ faz UMA coisa por vez.\n\nExemplos:\n\n- â€œclicar no Ã­coneâ€  \n- â€œrolar mais 500pxâ€  \n- â€œpegar o 3Âº item da listaâ€  \n- â€œler arquivo Xâ€  \n- â€œprocurar algo contendo Yâ€  \n- â€œabrir o primeiro resultadoâ€  \n\nO agente constrÃ³i *sequÃªncias* agrupando essas aÃ§Ãµes.\n\n---",
  "ğŸ“Œ 8. OperaÃ§Ãµes Compostas (ConstruÃ­das a partir das atÃ´micas)\n\nO agente pode inferir:\n\n- â€œprocurar arquivo do cliente JoÃ£o 2024â€  \n  â†’ fs_buscar_contextual + fs_inferir_tipo\n\n- â€œabrir o primeiro vÃ­deo do YouTubeâ€  \n  â†’ clicar_primeiro + seletor YouTube\n\n- â€œbaixar, mover e renomearâ€  \n  â†’ download + fs_mover + fs_renomear\n\n- â€œextrair dados da planilha e montar docxâ€  \n  â†’ xls_ler â†’ llm_reescrever â†’ docx_novo\n\n---",
  "ğŸ§  9. HeurÃ­sticas de InterpretaÃ§Ã£o Comportamental\n\n- â€œprimeiroâ€ = menor Ã­ndice da lista.  \n- â€œmais relevanteâ€ = heurÃ­stica: topo da pÃ¡gina.  \n- â€œresultado da buscaâ€ = Google: `a[jsname=\"UWckNb\"]`.  \n- â€œvÃ­deoâ€ = qualquer estrutura `<ytd-video-renderer>` ou `<ytd-rich-grid-media>`.  \n- â€œdocumentoâ€ = pdf/docx/txt/json conforme inferÃªncia.  \n- â€œplanilhaâ€ = xlsx/csv/ods.  \n- â€œimagemâ€ = png/jpg/jpeg.  \n- â€œclicar no que aparece parecido comâ€¦â€ = buscar por substring no texto.",
  "ğŸ—‚ï¸ 10. AÃ‡Ã•ES DE SISTEMA DE ARQUIVOS (FS) â€” DOCUMENTAÃ‡ÃƒO COMPLETA\n### ğŸ“ fs_pasta_atual()\n\nRetorna o caminho absoluto do diretÃ³rio atual de execuÃ§Ã£o.\n\nSem argumentos\n\nRetorno: string com o caminho\n\nEx.: \"C:/Users/DEV/Projetos\"\n\n### ğŸ“ fs_listar(path)\n\nLista arquivos e pastas dentro do diretÃ³rio informado (nÃ£o recursivo).\n\npath: string (\".\", \"C:/temp\", \"./src\", etc.)\n\nRetorno: array de hashes:\n{ nome: \"arquivo.txt\", tipo: \"file\" }\n\n### ğŸ“ fs_listar_recursivo(path)\n\nLista tudo recursivamente.\n\n### ğŸ” fs_buscar(path, padrao)\n\nBusca arquivos por padrÃ£o de nome.\n\npadrao: \"*.pdf\", \"*contrato*\" etc.\n\n### ğŸ” fs_buscar_contextual(path, termos[])\n\nBusca por nome + conteÃºdo (para arquivos leves).\n\ntermos: array de strings\n\nCombina nome OU conteÃºdo.\n\n### ğŸ“„ fs_ler_texto(path)\n\nLÃª .txt, .md, .rb, .html, .json, .csv\nRetorna string.\n\n### ğŸ“„ fs_ler_pdf(path)\n\nRetorna { tipo: :texto, conteudo: \"texto do pdf\" }.\n\n### ğŸ“„ fs_ler_planilha(path)\n\nLÃª .xlsx, retorna:\n{ tipo: :tabela, conteudo: [[linha1], [linha2], ...] }.\n\n### âœï¸ fs_copiar(origem, destino)\n\nCopia arquivo/pasta.\n\n### âœï¸ fs_mover(origem, destino)\n\nMove arquivo/pasta.\n\n### âœï¸ fs_deletar(path)\n\nRemove arquivo ou diretÃ³rio.\n\n### ğŸ“ fs_criar_pasta(path)\n\nCria diretÃ³rios recursivamente.\n\n### ğŸ“ fs_criar_arquivo(path, conteudo)\n\nCria arquivo texto com conteÃºdo inicial.\n\n### ğŸ§  fs_inferir_tipo(extensÃ£o)\n\nRetorna tipos como â€œtextoâ€, â€œpdfâ€, â€œplanilhaâ€, etc.",
  "ğŸ“Š FUNÃ‡Ã•ES DE PLANILHAS (EXPLICITAMENTE DOCUMENTADAS)\n\n### ğŸ“Š criar_xlsx(caminho_arquivo:, folhas_e_conteudo:)\n\nCria um arquivo .xlsx novo.\n\nArgumentos:\n\n\tcaminho_arquivo:\n\tCaminho completo do arquivo:\n\t\"C:/temp/minha.xlsx\" ou \"#{res1}/nova.xlsx\"\n\t\n\tfolhas_e_conteudo:\n\tHash onde:\n\t\n\tchave = nome da planilha\n\t\n\tvalor = matriz (array de arrays) representando linhas e colunas\n\nFormato esperado:\n\tcriar_xlsx(\n\t  caminho_arquivo: \"caminho/arquivo.xlsx\",\n\t  folhas_e_conteudo: {\n\t    \"Folha 1\" => [\n\t      [\"Nome\", \"Idade\"],\n\t      [\"JoÃ£o\", 30],\n\t      [\"Maria\", 25]\n\t    ]\n\t  }\n\t)\n\nRetorno:\n\n\tMensagem de confirmaÃ§Ã£o ou erro tratado.\n\n### âœï¸ inserir_conteudo_xlsx(caminho_arquivo:, celula:, valor:)\n\nInsere conteÃºdo em uma cÃ©lula especÃ­fica.\n\nArgumentos:\n\ncaminho_arquivo: caminho existente\n\ncelula: \"A1\", \"B3\", ou \"Folha 2!C7\"\n\nvalor: qualquer valor primitivo\n\nExemplo:\ninserir_conteudo_xlsx(\n  caminho_arquivo: \"#{res1}/nova.xlsx\",\n  celula: \"A1\",\n  valor: \"TÃ­tulo\"\n)\n\n### ğŸ“¦ Exemplos reais de uso (para o LLM seguir)\nğŸ“˜ Criar planilha na pasta atual\nsequence do\n  res1 = fs_pasta_atual()\n  res2 = criar_xlsx(\n    caminho_arquivo: \"#{res1}/nova_planilha.xlsx\",\n    folhas_e_conteudo: {\n      \"Folha 1\" => [\n        [\"Nome\", \"Valor\"],\n        [\"Item 1\", 100],\n        [\"Item 2\", 200]\n      ]\n    }\n  )\nend\n\n\n# ğŸ“˜ **CompreensÃ£o Simples e Completa Sobre Arquivos (VisÃ£o Humana e Neutra)**\n\n\n\n---",
  "ğŸ“ 1. Arquivos tÃªm um â€œlugar onde vivemâ€\n\nTodo arquivo tem um caminho completo, como:\n\n`C:/MeusDocumentos/contrato.docx`\n\nEsse caminho Ã© como o â€œendereÃ§oâ€ do arquivo.  \nO agente sempre usa esse caminho para:\n\n- achar o arquivo\n    \n- abrir\n    \n- mover\n    \n- copiar\n    \n- excluir\n    \n- ou fazer qualquer aÃ§Ã£o relacionada\n    \n\n---",
  "ğŸ·ï¸ 2. Arquivos tÃªm um nome\n\nO nome Ã© sÃ³ a Ãºltima parte do caminho:\n\n`contrato.docx`\n\nO agente usa isso para:\n\n- mostrar para o usuÃ¡rio\n    \n- identificar arquivos\n    \n- filtrar itens\n    \n\nMas o nome nunca substitui o caminho completo.\n\n---",
  "ğŸ“„ 3. Arquivos tÃªm um tipo\n\nO tipo de um arquivo Ã© determinado pela **extensÃ£o**, assim como para um usuÃ¡rio humano.\n\nAlguns exemplos:\n\n- `.txt` â†’ texto\n    \n- `.docx` â†’ documento\n    \n- `.pdf` â†’ PDF\n    \n- `.csv` â†’ tabela simples\n    \n- `.mp3` â†’ Ã¡udio\n    \n- `.png` â†’ imagem\n    \n\nNenhum tipo recebe prioridade.  \nO agente trata todos igualmente, apenas escolhendo a funÃ§Ã£o certa dependendo da extensÃ£o.\n\n---",
  "ğŸ” 4. Como o agente encontra arquivos\n\nDa mesma forma que alguÃ©m olha para uma pasta no computador e vÃª o que tem lÃ¡ dentro.\n\nO agente usa:\n\n- **fs_listar_diretorio** â†’ vÃª o que hÃ¡ em uma pasta\n    \n- **fs_listar_recursivo** â†’ vÃª tudo, inclusive subpastas\n    \n\nE cada item Ã© representado assim:\n\n`{   caminho: \"C:/pasta/arquivo.ext\",   nome: \"arquivo.ext\",   tipo: \"file\"  # ou \"dir\" }`\n\nIsso significa:\n\n- Ele sabe onde estÃ¡\n    \n- Ele sabe o nome\n    \n- Ele sabe se Ã© arquivo ou pasta\n    \n\nNenhuma suposiÃ§Ã£o adicional Ã© feita.\n\n---",
  "ğŸ“‚ 5. Como o agente identifica tipos\n\nAssim como uma pessoa vÃª â€œ.pdfâ€ e entende o que Ã©, o agente faz:\n\n`fs_inferir_tipo(File.extname(item[:caminho]))`\n\nE recebe de volta algo como â€œtextoâ€, â€œdocumentoâ€, â€œimagemâ€, â€œplanilhaâ€, â€œpdfâ€, etc.\n\nIsso evita que o agente precise adivinhar.\n\n---",
  "ğŸ“– 6. Como o agente lÃª arquivos\n\nA leitura Ã© feita do jeito mais natural para humanos:\n\n- Arquivos de texto â†’ viram texto\n    \n- Documentos â†’ retornam texto extraÃ­do\n    \n- Tabelas e planilhas â†’ viram tabelas de linhas e colunas\n    \n- PDFs â†’ viram texto extraÃ­do\n    \n- Outros arquivos â†’ podem ser lidos conforme sua funÃ§Ã£o especÃ­fica\n    \n\nNÃ£o importa qual seja o tipo.  \nO agente sÃ³ escolhe como ler com base na extensÃ£o.\n\n---",
  "ğŸ“ 7. Como o agente cria arquivos\n\nCriar arquivos funciona como â€œsalvarâ€ ou â€œcriar novo arquivoâ€ para um usuÃ¡rio:\n\n- Criar arquivos de texto\n    \n- Criar diretÃ³rios\n    \n- Criar documentos de tipos variados\n    \n- Criar tabelas ou estruturas organizadas\n    \n\nEssa criaÃ§Ã£o Ã© sempre **clara, direta e explÃ­cita**, com caminho e conteÃºdo definidos pelo usuÃ¡rio ou pelo sistema.\n\n---",
  "ğŸ”„ 8. Como o agente manipula arquivos\n\nAs operaÃ§Ãµes seguem o entendimento natural que qualquer pessoa jÃ¡ tem:\n\n- **copiar** â†’ fazer uma cÃ³pia\n    \n- **mover** â†’ trocar de lugar\n    \n- **deletar** â†’ remover\n    \n- **renomear** â†’ mudar o nome\n    \n- **criar** â†’ gerar arquivo novo\n    \n- **listar** â†’ ver o que existe em uma pasta\n    \n\nNenhuma operaÃ§Ã£o envolve adivinhaÃ§Ã£o ou tentativas complexas.\n\n---",
  "âš™ï¸ 9. Como o agente verifica se um arquivo existe\n\nDo mesmo modo que alguÃ©m abre uma pasta e checa:\n\n1. Ele lista os arquivos\n    \n2. Compara nomes/extensÃµes\n    \n3. Confirma se algo corresponde ao que estÃ¡ procurando\n    \n\nIsso vale para **qualquer extensÃ£o**, sem priorizar nenhuma.\n\n---",
  "âœ”ï¸ 10. Resumo humano\n\nO agente deve pensar sobre arquivos como uma pessoa comum pensa:\n\n> â€œUm arquivo fica em uma pasta, tem um nome, tem um tipo  \n> e eu posso abrir, mover, copiar, listar ou criar ele.â€\n\nNenhum formato Ã© favorito, nenhum Ã© especial.  \nTodos sÃ£o tratados igualmente."
]